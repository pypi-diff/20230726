# Comparing `tmp/mariqt_widgets-0.3.1-py2.py3-none-any.whl.zip` & `tmp/mariqt_widgets-0.3.3-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,17 +1,17 @@
-Zip file size: 45923 bytes, number of entries: 15
--rw-r--r--  2.0 unx      128 b- defN 23-Jul-17 08:36 mariqt_widgets/__init__.py
--rw-r--r--  2.0 unx   106778 b- defN 23-Jul-17 08:36 mariqt_widgets/ifdo_create.py
--rw-r--r--  2.0 unx     7851 b- defN 23-Jul-17 08:36 mariqt_widgets/ifdo_excel.py
--rw-r--r--  2.0 unx    52498 b- defN 23-Jul-17 08:36 mariqt_widgets/notebook_widgets.py
--rw-rw-rw-  2.0 unx     1520 b- defN 23-Jun-20 13:58 mariqt_widgets/icons/checkbox-circle-line_gray.png
--rw-rw-rw-  2.0 unx     1525 b- defN 23-Jun-20 13:58 mariqt_widgets/icons/checkbox-circle-line_green.png
--rw-rw-rw-  2.0 unx     1502 b- defN 23-Jun-20 13:58 mariqt_widgets/icons/error-warning-line_gray.png
--rw-rw-rw-  2.0 unx     1513 b- defN 23-Jun-20 13:58 mariqt_widgets/icons/error-warning-line_orange.png
--rw-rw-rw-  2.0 unx     1470 b- defN 23-Jun-20 13:58 mariqt_widgets/icons/error-warning-line_red.png
--rw-rw-rw-  2.0 unx      118 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/AUTHORS.md
--rw-rw-rw-  2.0 unx     1506 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/LICENSE
--rw-r--r--  2.0 unx     1443 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/METADATA
--rw-r--r--  2.0 unx      110 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/WHEEL
--rw-r--r--  2.0 unx       15 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     1397 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/RECORD
-15 files, 179374 bytes uncompressed, 43565 bytes compressed:  75.7%
+Zip file size: 46310 bytes, number of entries: 15
+-rw-r--r--  2.0 unx      128 b- defN 23-Jul-26 10:53 mariqt_widgets/__init__.py
+-rw-r--r--  2.0 unx   106778 b- defN 23-Jul-26 10:53 mariqt_widgets/ifdo_create.py
+-rw-r--r--  2.0 unx     9043 b- defN 23-Jul-26 10:53 mariqt_widgets/ifdo_excel.py
+-rw-r--r--  2.0 unx    52527 b- defN 23-Jul-26 10:53 mariqt_widgets/notebook_widgets.py
+-rw-rw-rw-  2.0 unx     1520 b- defN 23-Jul-26 10:53 mariqt_widgets/icons/checkbox-circle-line_gray.png
+-rw-rw-rw-  2.0 unx     1525 b- defN 23-Jul-26 10:53 mariqt_widgets/icons/checkbox-circle-line_green.png
+-rw-rw-rw-  2.0 unx     1502 b- defN 23-Jul-26 10:53 mariqt_widgets/icons/error-warning-line_gray.png
+-rw-rw-rw-  2.0 unx     1513 b- defN 23-Jul-26 10:53 mariqt_widgets/icons/error-warning-line_orange.png
+-rw-rw-rw-  2.0 unx     1470 b- defN 23-Jul-26 10:53 mariqt_widgets/icons/error-warning-line_red.png
+-rw-rw-rw-  2.0 unx      118 b- defN 23-Jul-26 10:53 mariqt_widgets-0.3.3.dist-info/AUTHORS.md
+-rw-rw-rw-  2.0 unx     1506 b- defN 23-Jul-26 10:53 mariqt_widgets-0.3.3.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1443 b- defN 23-Jul-26 10:53 mariqt_widgets-0.3.3.dist-info/METADATA
+-rw-r--r--  2.0 unx      110 b- defN 23-Jul-26 10:53 mariqt_widgets-0.3.3.dist-info/WHEEL
+-rw-r--r--  2.0 unx       15 b- defN 23-Jul-26 10:53 mariqt_widgets-0.3.3.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1397 b- defN 23-Jul-26 10:53 mariqt_widgets-0.3.3.dist-info/RECORD
+15 files, 180595 bytes uncompressed, 43952 bytes compressed:  75.7%
```

## zipnote {}

```diff
@@ -21,26 +21,26 @@
 
 Filename: mariqt_widgets/icons/error-warning-line_orange.png
 Comment: 
 
 Filename: mariqt_widgets/icons/error-warning-line_red.png
 Comment: 
 
-Filename: mariqt_widgets-0.3.1.dist-info/AUTHORS.md
+Filename: mariqt_widgets-0.3.3.dist-info/AUTHORS.md
 Comment: 
 
-Filename: mariqt_widgets-0.3.1.dist-info/LICENSE
+Filename: mariqt_widgets-0.3.3.dist-info/LICENSE
 Comment: 
 
-Filename: mariqt_widgets-0.3.1.dist-info/METADATA
+Filename: mariqt_widgets-0.3.3.dist-info/METADATA
 Comment: 
 
-Filename: mariqt_widgets-0.3.1.dist-info/WHEEL
+Filename: mariqt_widgets-0.3.3.dist-info/WHEEL
 Comment: 
 
-Filename: mariqt_widgets-0.3.1.dist-info/top_level.txt
+Filename: mariqt_widgets-0.3.3.dist-info/top_level.txt
 Comment: 
 
-Filename: mariqt_widgets-0.3.1.dist-info/RECORD
+Filename: mariqt_widgets-0.3.3.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mariqt_widgets/__init__.py

```diff
@@ -1,5 +1,5 @@
 """Top-level package for mariqt_widgets."""
 
 __author__ = """Karl Heger"""
 __email__ = 'kheger@geomar.de'
-__version__ = '0.3.1'
+__version__ = '0.3.3'
```

## mariqt_widgets/ifdo_excel.py

```diff
@@ -1,10 +1,13 @@
 import sys
 #sys.path.insert(0, '/home/karl/Documents/HMC/mariqt/') # just for testing!
 import pandas as pd
+from pandas.io.formats.excel import ExcelFormatter
+ExcelFormatter.header_style = None
+
 import os
 from pprint import pprint
 
 import mariqt.sources.ifdo as miqtf
 import mariqt.files as miqtff
 import mariqt.variables as miqtv
 import mariqt.sources.ifdo as miqtiFDO
@@ -19,22 +22,26 @@
     inputDir: directory will be recursively searched for iFDO files matching ```filter``` and excluding directories from ```ignoreSubDirs```
     ignoreSubDirs: list of folder names to ignore during search for iFDO files
     filter: dictionary to consider only those iFDO matching provided *image-set-header* field values of form ```{<header-field>:[<option1>,...]}``` set ```{}``` to ignore.
     outputFields: list of *image-set-header* fields to be exported as lines in Excel in the specified order. """
     
     # find iFOD files
     trunciFDODicts = []
-    iFDOfiles = miqtff.browseForFiles(input_dir,['json'],ignoreSubDirs=ignore_sub_dirs)
-    iFDOfiles.sort()
+    json_files = miqtff.browseForFiles(input_dir,['json'],ignoreSubDirs=ignore_sub_dirs)
+    json_files.sort()
 
     i = 0
-    for iFDOfile in iFDOfiles:
+    for json_file in json_files:
+        
+        if json_file[-9::] != "iFDO.json":
+            print("skipping",json_file)
+            continue
         
-        print("reading",iFDOfile)
-        iFDO_reader = miqtf.iFDO_Reader(iFDOfile)
+        print("reading",json_file)
+        iFDO_reader = miqtf.iFDO_Reader(json_file)
         iFDO_Obj = iFDO_reader.ifdo
 
         if not filter is {}:
             skip = False
             for f in filter:
                 if not iFDO_Obj['image-set-header'][f] in filter[f]:
                     skip = True
@@ -72,18 +79,26 @@
         allow_values = _get_allowed_values(ifdo_fields[field])
 
         fieldExpl.append([field,allow_values,ifdo_fields[field]['description']])
         #fieldExpl.append([field,allow_values,miqtv.ifdo_fields[field]['comment']])
     df_fieldExpl = pd.DataFrame(fieldExpl,columns=['iFDO fields','Allowed values','Explanation'])
 
     # create a excel writer object
-    with pd.ExcelWriter(output_file) as writer:
+    with pd.ExcelWriter(output_file,engine='xlsxwriter') as writer:
+
+        workbook  = writer.book
+        format = workbook.add_format()
+        format.set_align('left')
+
         df.style.applymap(lambda _: 'vertical-align: top').to_excel(writer,header=False,sheet_name="Stations")
         df_fieldExpl.style.applymap(lambda _: 'vertical-align: top').to_excel(writer,sheet_name="Field Explanation",index=False)
 
+        worksheet = writer.sheets["Stations"]
+        worksheet.set_column(0, i, 40)
+
     print("Wrote to",output_file)
 
 def _get_allowed_values(obj:dict):
     type = obj['type']
     ret = type
     if type != 'object':
         for field in obj:
@@ -98,22 +113,32 @@
             sub_ret += sub_field + ": " + _get_allowed_values(obj['properties'][sub_field]) + ", "
         ret = 'dict {' + sub_ret + "}"
     return ret
 
 
 
 
-def ifdo_update_from_excel(input_excel_file:str, ifdo_file:str, sheet_name:str):
+def ifdo_update_from_excel(input_excel_file:str, ifdo_file:str, sheet_name:str,ignore_sub_dirs:list=['raw','protocol','intermediate','extern','processed']):
     """ Updates iFDO's header fields from an Excel sheet.
     input_excel_file: input Excel file (generate with *iFDO_exportToExcel.ipynb* and edit)
-    ifdo_file: iFDO file to be updated
+    ifdo_file: iFDO file to be updated. If is not file but dir, dir is scanned for ifdo files, applying ignore_sub_dirs
     sheet_name: name of the sheet in the input Excel file containing the respective data """
 
     print("Using mariqt version",miqtv.version)
 
+    if not os.path.isfile(ifdo_file) and os.path.isdir(ifdo_file):
+        print("Not an iFDO file but directory provided. Searching for iFDO files in directory.")
+        ifdo_files = miqtff.browseForFiles(ifdo_file,['json'],ignoreSubDirs=ignore_sub_dirs)
+        ifdo_files = [e for e in ifdo_files if e[-9::] == "iFDO.json"]
+        ifdo_files.sort()
+        print("Found",len(ifdo_files),"iFDO files.")
+    else:
+        ifdo_files = [ifdo_file]
+
+    print("Reading Excel file.")
     excel_data_df = pd.read_excel(input_excel_file, sheet_name, header=None,dtype = str)
     
     # remove uncool chars
     excel_data_df = excel_data_df.replace({'‘':'\'','’':'\''},regex=True)
     excel_data_df_dict = excel_data_df.to_dict(orient='index')
 
     # find 'image-set-name' and create index -> image-set-name dict
@@ -140,24 +165,28 @@
                     if str(val).lower() == "nan" or str(val).strip() == "":
                         val = ""
                     setUpdates[imageSetsIndices[fieldIndex]][fieldName] = val
 
     #pprint(setUpdates)
     
     # create iFDO object
-    iFDO = miqtiFDO.iFDOFromFile(ifdo_file, ignore_image_files=True)
-
-    #pprint(iFDO.ifdo_tmp)
-
-    if iFDO.findTmpField('image-set-name') not in setUpdates:
-        raise Exception("Could not find image set in Excel: " + iFDO.findTmpField('image-set-name'))
 
-    iFDO.update_ifdo_header_fields(setUpdates[iFDO.findTmpField('image-set-name')])
-    iFDO.update_fields()
-    iFDO.write_ifdo_file()
+    for ifdo_file in ifdo_files:
+        print("Updating iFDO file",ifdo_file)
+        iFDO = miqtiFDO.iFDOFromFile(ifdo_file, ignore_image_files=True)
+
+        #pprint(iFDO.ifdo_tmp)
+
+        if iFDO.findTmpField('image-set-name') not in setUpdates:
+            print("Could not find image set in Excel: " + iFDO.findTmpField('image-set-name'),", skipping!")
+            continue
+
+        iFDO.update_ifdo_header_fields(setUpdates[iFDO.findTmpField('image-set-name')])
+        iFDO.update_fields()
+        iFDO.write_ifdo_file()
 
 
 def excel_to_markdown(input_excel_file:str, sheet_name:str=None, output_file:str=None, overwrite=False):
     """ Convert Excel file to markdown table """
     if sheet_name is None:
         df = pd.read_excel(input_excel_file)
     else:
```

## mariqt_widgets/notebook_widgets.py

```diff
@@ -684,19 +684,21 @@
         try:
             with open(self.auxFile_file_widget.selected,'r') as f:
                 self.fileValid.valid = True
                 separator = self.fileSeparator.value
                 first_line = f.readline().strip()
                 fileHeaders = first_line.split(separator)
                 self.columnOptions = fileHeaders
+
                 for child in self.auxFile_ColumnsBox_widget.children:
                     if isinstance(child, HeaderFieldWidget):
                         child.setColumnOptions(fileHeaders)
-        except (FileNotFoundError, UnicodeDecodeError):
+        except (FileNotFoundError, UnicodeDecodeError) as ex:
             self.fileValid.valid = False
+            print(ex)
         
         for req in self.requirtedFieldWidgets:
             try:
                 req.dropdown_columnName.value = difflib.get_close_matches(req.comboBox_field.value,req.dropdown_columnName.options)[0]
             except IndexError:
                 pass
```

## Comparing `mariqt_widgets-0.3.1.dist-info/LICENSE` & `mariqt_widgets-0.3.3.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mariqt_widgets-0.3.1.dist-info/METADATA` & `mariqt_widgets-0.3.3.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mariqt-widgets
-Version: 0.3.1
+Version: 0.3.3
 Summary: Contains widgets commonly used by MarIQT Notebooks.
 Home-page: https://codebase.helmholtz.cloud/datahub/marehub/ag-videosimages/mariqt-notebook-widgets
 Author: Karl Heger
 Author-email: kheger@geomar.de
 License: GNU General Public License v3
 Keywords: mariqt_widgets
 Classifier: Development Status :: 2 - Pre-Alpha
```

## Comparing `mariqt_widgets-0.3.1.dist-info/RECORD` & `mariqt_widgets-0.3.3.dist-info/RECORD`

 * *Files 17% similar despite different names*

```diff
@@ -1,15 +1,15 @@
-mariqt_widgets/__init__.py,sha256=p3CNQ5qJI5rNvZq1B9qM4e87GEJlVwzkXiNpTSD0tUM,128
+mariqt_widgets/__init__.py,sha256=xKw4EBeDgByLnephYAtCFBn6kpovb7rBtbHSZAWlcBY,128
 mariqt_widgets/ifdo_create.py,sha256=wAIHtV-BUXDjkejfeByag1AnMaZjHjsVscDmc_6KytM,106778
-mariqt_widgets/ifdo_excel.py,sha256=qVz0Tsz1djxzYajVFgis8ohrXS_ZWrtdYVCypz6aMwk,7851
-mariqt_widgets/notebook_widgets.py,sha256=074sLRRNtLSmaaHM5rKK4aCLFLFO7u6zjyQL4i-a1Wg,52498
+mariqt_widgets/ifdo_excel.py,sha256=q5sypU_nawdIp2Z6ZDqaStkDhUu_6wDNY8ioYve7-94,9043
+mariqt_widgets/notebook_widgets.py,sha256=bxTtpXjtKM5qRAk_O5vdKl8Ge0fydtscrTwEZd9JxXg,52527
 mariqt_widgets/icons/checkbox-circle-line_gray.png,sha256=RaFzsWg0opiHsSYaOP61cLgu36lVDLnwyNUsJwMhnww,1520
 mariqt_widgets/icons/checkbox-circle-line_green.png,sha256=jHZmxJJLY-7dMGDUxBYAkBCFySeS05DQPbAd7vmX49s,1525
 mariqt_widgets/icons/error-warning-line_gray.png,sha256=_ZjMCCHce_zdD9QekKubV66bHwicRIY1ncjy1O8wTmE,1502
 mariqt_widgets/icons/error-warning-line_orange.png,sha256=3Jt4GaLi-mHRPDz9lLHbwwvUaG2gttT-J90WquqXMNk,1513
 mariqt_widgets/icons/error-warning-line_red.png,sha256=gF0m6xbCcX1LQ0kwjIkPln6eLGOL9dSF2h4rqEjU0HU,1470
-mariqt_widgets-0.3.1.dist-info/AUTHORS.md,sha256=fHR702RktmLjB6uJ0FIzG-DTjVXU4tQ4mFh0jeBP-Ns,118
-mariqt_widgets-0.3.1.dist-info/LICENSE,sha256=OHxJeWWJWP1rrSwBbdFqDnWwhFn2dM_2L7mtXcqSh-c,1506
-mariqt_widgets-0.3.1.dist-info/METADATA,sha256=OO85_24kCol3TDBcXMQetoMgy9dabln5dbMZ5m-1O4U,1443
-mariqt_widgets-0.3.1.dist-info/WHEEL,sha256=a-zpFRIJzOq5QfuhBzbhiA1eHTzNCJn8OdRvhdNX0Rk,110
-mariqt_widgets-0.3.1.dist-info/top_level.txt,sha256=Ul1udsokY_DyTjF0ePRHxZjs46MX931t8CKpdL2oDTc,15
-mariqt_widgets-0.3.1.dist-info/RECORD,,
+mariqt_widgets-0.3.3.dist-info/AUTHORS.md,sha256=fHR702RktmLjB6uJ0FIzG-DTjVXU4tQ4mFh0jeBP-Ns,118
+mariqt_widgets-0.3.3.dist-info/LICENSE,sha256=OHxJeWWJWP1rrSwBbdFqDnWwhFn2dM_2L7mtXcqSh-c,1506
+mariqt_widgets-0.3.3.dist-info/METADATA,sha256=Yase2jvVa97GbzGB4-6vFAP3Uqp0oIKnXHe5LnOe1vg,1443
+mariqt_widgets-0.3.3.dist-info/WHEEL,sha256=k3vXr0c0OitO0k9eCWBlI2yTYnpb_n_I2SGzrrfY7HY,110
+mariqt_widgets-0.3.3.dist-info/top_level.txt,sha256=Ul1udsokY_DyTjF0ePRHxZjs46MX931t8CKpdL2oDTc,15
+mariqt_widgets-0.3.3.dist-info/RECORD,,
```

